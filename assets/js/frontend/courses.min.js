const{debounce:debounce}=lodash,lpArchiveAddQueryArgs=(e,t)=>{const r=new URL(e);return Object.keys(t).forEach(e=>{r.searchParams.append(e,t[e])}),r},lpArchiveCourse=()=>{const e=document.querySelectorAll(".lp-archive-course-skeleton");if(e.length&&"IntersectionObserver"in window){const t=new IntersectionObserver((e,r)=>{e.forEach(e=>{if(e.isIntersecting){const r=e.target;if(!lpArchiveSkeleton)return;setTimeout((function(){lpArchiveRequestCourse(lpArchiveSkeleton)}),600),t.unobserve(r)}})});[...e].map(e=>t.observe(e))}},lpArchiveRequestCourse=e=>{const t=lpGlobalSettings.lp_rest_url,r=lpGlobalSettings.user_id||"";if(!t)return;const s=document.querySelector(".lp-archive-courses"),n=s&&s.querySelector("div.lp-archive-courses .lp-content-area"),o=n&&n.querySelector("ul.learn-press-courses");if(!o)return;if(s.classList.contains("loading"))return;const c=document.querySelector(".lp-archive-course-skeleton");c&&c.remove(),s.classList.add("loading"),fetch(lpArchiveAddQueryArgs(t+"lp/v1/courses/archive-course",{...e,userID:r}),{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{void 0!==e.data.content&&o&&(o.innerHTML=e.data.content||"");const t=e.data.pagination;if(void 0!==t){const e=(new DOMParser).parseFromString(t,"text/html").querySelector(".learn-press-pagination"),r=e&&e.innerHTML,s=document.querySelector(".learn-press-pagination");s?r?s.innerHTML=r||"":s.remove():jQuery(o).after(t)}}).catch(e=>{o.innerHTML+=`<div class="lp-ajax-message error" style="display:block">${e.message||"Error: Query lp/v1/courses/archive-course"}</div>`}).finally(()=>{s.classList.remove("loading"),LPArchiveCourseInit()})},lpArchiveSearchCourse=()=>{const e=document.querySelectorAll('.search-courses input[name="s"]');e.length>0&&e.forEach(e=>e.addEventListener("keyup",debounce(e=>{e.preventDefault();const t=e.target.value;t&&t.length>2&&lpArchiveRequestCourse({...lpArchiveSkeleton,s:t})},500)))},lpArchivePaginationCourse=()=>{const e=document.querySelectorAll(".lp-archive-courses .learn-press-pagination .page-numbers");e.length>0&&e.forEach(t=>t.addEventListener("click",r=>{r.preventDefault(),r.stopPropagation();const s=r.currentTarget.getAttribute("href");if(s){const n=new URL(s),o={};n.searchParams.forEach((e,t)=>{o[t]=e});const c=[...e].filter(e=>e.classList.contains("current")),a=r.currentTarget.textContent||t.classList.contains("next")&&parseInt(c[0].textContent)+1||t.classList.contains("prev")&&parseInt(c[0].textContent)-1;lpArchiveRequestCourse({...o,paged:a}),window.history.pushState("","",s)}}))},lpArchiveGridListCourse=()=>{const e=LP.Cookies.get("courses-layout"),t=document.querySelectorAll('.lp-courses-bar .switch-layout [name="lp-switch-layout-btn"]');t.length>0&&[...t].map(t=>t.value===e&&(t.checked=!0))},lpArchiveGridListCourseHandle=()=>{const e=document.querySelectorAll('.lp-archive-courses input[name="lp-switch-layout-btn"]');e.length>0&&e.forEach(e=>e.addEventListener("change",e=>{e.preventDefault();const t=e.target.value;if(t){const e=document.querySelector(".lp-archive-courses .learn-press-courses[data-layout]");e&&(e.dataset.layout=t),LP.Cookies.set("courses-layout",t)}}))};function LPArchiveCourseInit(){lpArchiveCourse(),lpArchiveSearchCourse(),lpArchiveGridListCourseHandle(),lpArchivePaginationCourse(),lpArchiveGridListCourse()}document.addEventListener("DOMContentLoaded",(function(e){LPArchiveCourseInit()}));