const{debounce:debounce}=lodash,addQueryArgs=(e,r)=>{const t=new URL(e);return Object.keys(r).forEach(e=>{t.searchParams.append(e,r[e])}),t},requestCourse=e=>{const r=lpGlobalSettings.lp_rest_url,t=lpGlobalSettings.user_id||"";if(!r)return;const s=document.querySelector(".lp-archive-courses"),a=s&&s.querySelector("div.lp-archive-courses .lp-content-area"),o=a&&a.querySelector("ul.learn-press-courses");o&&(s.classList.add("loading"),fetch(addQueryArgs(r+"lp/v1/courses/archive-course",{...e,userID:t}),{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{void 0!==e.data.content&&o&&(o.innerHTML=e.data.content||"");const r=e.data.pagination;if(void 0!==r){const e=(new DOMParser).parseFromString(r,"text/html").querySelector(".learn-press-pagination"),t=e&&e.innerHTML,s=document.querySelector(".learn-press-pagination");s?t?s.innerHTML=t||"":s.remove():a.innerHTML+=r}paginationCourse()}).catch(e=>{o.innerHTML+=`<div class="lp-ajax-message error" style="display:block">${e.message||"Error: Query lp/v1/courses/archive-course"}</div>`}).finally(()=>{s.classList.remove("loading")}))},searchCourse=debounce(e=>{e.preventDefault(),requestCourse({s:e.target.value})},600),paginationCourse=()=>{const e=document.querySelectorAll(".lp-archive-courses .learn-press-pagination .page-numbers");e.length>0&&e.forEach(e=>e.addEventListener("click",e=>{e.preventDefault();const r=e.target.getAttribute("href");if(r){const t=new URL(r),s=t.searchParams.get("s")||"",a=t.searchParams.get("orderby")||"",o=t.searchParams.get("order")||"",n=e.target.textContent||1;requestCourse({s:s,page:n,order:o,orderby:a})}}))},gridListCourse=()=>{const e=LP.Cookies.get("courses-layout"),r=document.querySelectorAll('.lp-courses-bar .switch-layout [name="lp-switch-layout-btn"]');r.length>0&&[...r].map(r=>r.value===e&&(r.checked=!0))},gridListCourseHandle=e=>{e.preventDefault();const r=e.target.value;if(r){const e=document.querySelector(".lp-archive-courses .learn-press-courses[data-layout]");e&&(e.dataset.layout=r),LP.Cookies.set("courses-layout",r)}};document.addEventListener("DOMContentLoaded",(function(e){const r=document.querySelector(".lp-archive-courses"),t=r.querySelectorAll('.search-courses input[name="s"]'),s=r.querySelectorAll("form.search-courses");r.querySelectorAll('input[name="lp-switch-layout-btn"]').forEach(e=>e.addEventListener("change",gridListCourseHandle)),t.forEach(e=>e.addEventListener("keyup",searchCourse)),s.forEach(e=>e.addEventListener("submit",r=>{r.preventDefault();const t=e.querySelector('input[name="s"]');t&&t.dispatchEvent(new Event("keyup"))})),paginationCourse(),gridListCourse()}));