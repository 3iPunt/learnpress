!function(e){var t={};function i(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=31)}({31:function(e,t){!function(e){"use strict";var t=function e(t){this.view=new e.View({model:new e.Model(t)})};t.View=Backbone.View.extend({events:{"click #lp-remove-upload-photo":"_removePhoto","click #lp-upload-photo":"_upload","click .lp-cancel-upload":"_cancel"},el:"#lp-user-edit-avatar",uploader:null,initialize:function(){_.bindAll(this,"filesAdded","uploadProgress","uploadError","fileUploaded","crop"),this._getUploader()},_removePhoto:function(e){e.preventDefault(),this.$(".profile-picture").toggle().filter(".profile-avatar-current").remove(),this.$("#lp-remove-upload-photo").hide(),this.$("#submit").prop("disabled",!1)},_upload:function(e){e.preventDefault()},_cancel:function(e){e.preventDefault(),this.$crop&&this.$crop.remove(),this.$(".lp-avatar-preview").removeClass("croping")},filesAdded:function(e,t){e.files.splice(0,e.files.length-1),this.$(".lp-avatar-preview").addClass("uploading"),this.$(".lp-avatar-upload-progress-value").width(0),this.uploader.start()},uploadProgress:function(e,t){this.$(".lp-avatar-upload-progress-value").css("width",t.percent+"%")},uploadError:function(e,t){this.$(".lp-avatar-preview").addClass("upload-error").removeClass("uploading"),this.$(".lp-avatar-upload-error").html(t)},fileUploaded:function(t,i,r){this.$(".lp-avatar-preview").removeClass("upload-error").removeClass("uploading");var a=this,o=LP.parseJSON(r.response);o.url&&(this.avatar=o.url,e("<img/>").attr("src",o.url).load((function(){a.model.set(e.extend(o,{width:this.width,height:this.height})),a.crop()})))},crop:function(){this.model.set("r",Math.random()),new t.Crop(this),this.$("#submit").prop("disabled",!1)},_getUploader:function(){return this.uploader?this.uploader:(this.uploader=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:"lp-upload-photo",container:e("#lp-user-edit-avatar").get(0),url:("undefined"!=typeof lpGlobalSettings?lpGlobalSettings.ajax:"").addQueryVar("action","learnpress_upload-user-avatar"),filters:{max_file_size:"10mb",mime_types:[{title:"Image",extensions:"png,jpg,bmp,gif"}]},file_data_name:"lp-upload-avatar",init:{PostInit:function(){},FilesAdded:this.filesAdded,UploadProgress:this.uploadProgress,FileUploaded:this.fileUploaded,Error:this.uploadError}}),this.uploader.init(),this.uploader)}}),t.Model=Backbone.Model.extend({}),t.Crop=function(t){var i=this,r=t.model.toJSON(),a=e(LP.template("tmpl-crop-user-avatar")(r));a.appendTo(t.$(".lp-avatar-preview").addClass("croping")),t.$crop=a;var o=a.find("img"),n=0,s=0,l=0,d=0,p=0,u=0;this.initCrop=function(){r.viewWidth/r.viewHeight>=r.width/r.height?(n=r.viewWidth,s=r.height*r.viewWidth/r.width,l=0,d=-(s-r.viewHeight)/2):(s=r.viewHeight,n=r.width*r.viewHeight/r.height,d=0,l=-(n-r.viewWidth)/2),p=n,u=s,o.draggable({drag:function(t,i){i.position.left>0&&(i.position.left=0),i.position.top>0&&(i.position.top=0);var a=r.viewWidth-p,o=r.viewHeight-u;a>i.position.left&&(i.position.left=a),o>i.position.top&&(i.position.top=o),e(document.body).addClass("profile-dragging")},stop:function(a,n){l=parseInt(o.css("left")),d=parseInt(o.css("top")),t=(Math.abs(l)+r.viewWidth/2)/p,c=(Math.abs(d)+r.viewHeight/2)/u,i.update({width:p,height:u,top:d,left:l}),e(document.body).removeClass("profile-dragging")}});var t=(Math.abs(l)+r.viewWidth/2)/n,c=(Math.abs(d)+r.viewHeight/2)/s;a.find(".lp-zoom > div").slider({create:function(){i.update({width:n,height:s,top:d,left:l})},slide:function(a,o){p=n+o.value/100*r.width*2,u=s+o.value/100*r.height*2;var h=r.viewWidth/2-p*t,f=r.viewHeight/2-u*c;h>0&&(h=0),f>0&&(f=0);var v=parseInt(r.viewWidth-p),g=parseInt(r.viewHeight-u);v>h&&(h=l=v),g>f&&(f=d=g),i.update({width:p,height:u,top:f,left:h}),e(document.body).addClass("profile-resizing"),console.log(o.value,r)},stop:function(){e(document.body).removeClass("profile-resizing")}})},this.update=function(t){o.css({width:t.width,height:t.height,top:t.top,left:t.left});var i=t.width/r.width,n=parseInt(Math.abs(t.left/i)),s=parseInt(Math.abs(t.top/i)),l=n+parseInt(r.viewWidth/i),d=s+parseInt(r.viewHeight/i),p=e.extend(t,{width:r.viewWidth,height:r.viewHeight,r:i,points:[n,s,l,d].join(",")});a.find('input[name^="lp-user-avatar-crop"]').each((function(){var t=e(this),i=t.data("name");"name"!=i&&t.val(p[i])}))},this.initCrop()},e(document).on("submit","#learn-press-form-login",(function(t){var i=e(this),r=i.serialize();return i.find(".learn-press-error, .learn-press-notice, .learn-press-message").fadeOut(),i.find("input").attr("disabled",!0),LP.doAjax({data:{"lp-ajax":"login",data:r},success:function(t,r){LP.showMessages(t.message,i,"LOGIN_ERROR"),"error"==t.result&&(i.find("input").attr("disabled",!1),e('#learn-press-form-login input[type="text"]').focus()),t.redirect&&LP.reload(t.redirect)},error:function(){LP.showMessages("",i,"LOGIN_ERROR"),i.find("input").attr("disabled",!1),e('#learn-press-form-login input[type="text"]').focus()}}),!1})),e(document).on("click",".table-orders .cancel-order",(function(t){t.preventDefault();var i=e(this).attr("href");return LP.alert(learn_press_js_localize.confirm_cancel_order,(function(e){e&&(window.location.href=i)})),!1})),e(document).ready((function(){var r=e("#lp-user-profile-form form"),a=r.serialize(),o=null,n=r.find("#lp-profile-edit-password-form");function s(){r.find("#submit").prop("disabled",!(r.serialize()!=a))}0==n.length?r.on("keyup change","input, textarea, select",(function(){o&&clearTimeout(o),o=setTimeout(s,300)})):n.on("change keyup","input",(function(t){e(t.target).attr("name");var i=r.find("#pass0"),a=r.find("#pass1"),o=r.find("#pass2"),n=!((a.val()||o.val())&&a.val()!=o.val());r.find("#lp-password-not-match").toggleClass("hide-if-js",n),r.find("#submit").prop("disabled",!(n&&i.val()&&a.val()&&o.val()))}));var l={};"undefined"!=typeof lpProfileUserSettings&&(l.viewWidth=parseInt(lpProfileUserSettings.avatar_size.width),l.viewHeight=parseInt(lpProfileUserSettings.avatar_size.height)),new t(l),i.recoverOrder()}));var i={recoverOrder:function(t){var i=e(".order-recover"),r=i.find(".button-recover-order"),a=i.find('input[name="order-key"]');function o(){r.addClass("disabled").attr("disabled","disabled"),i.find(".learn-press-message").remove(),e.post({url:"",data:i.serializeJSON(),success:function(t){if((t=LP.parseJSON(t)).message){var a=e('<div class="learn-press-message icon"><i class="fa"></i> '+t.message+"</div>");"error"==t.result&&a.addClass("error"),i.prepend(a)}t.redirect&&(window.location.href=t.redirect),r.removeClass("disabled").removeAttr("disabled","")}})}r.on("click",o),a.on("change",(function(){r.prop("disabled",!this.value)}))}}}(jQuery)}});