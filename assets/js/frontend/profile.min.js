!function(e){var t={};function a(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(i,r,function(t){return e[t]}.bind(null,r));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=32)}({32:function(e,t){!function(e){"use strict";var t=function e(t){this.view=new e.View({model:new e.Model(t)})};t.View=Backbone.View.extend({events:{"click #lp-remove-upload-photo":"_removePhoto","click #lp-upload-photo":"_upload","click .lp-cancel-upload":"_cancel","click .lp-save-upload":"_save"},el:"#lp-user-edit-avatar",uploader:null,initialize:function(){_.bindAll(this,"filesAdded","uploadProgress","uploadError","fileUploaded","crop"),this._getUploader()},_save:function(t){t.preventDefault();var a=this;e.ajax({url:"?lp-ajax=save-uploaded-user-avatar",data:this.$(".lp-avatar-crop-image").serializeJSON(),type:"post",success:function(t){(t=LP.parseJSON(t)).success&&(a.$(".lp-avatar-crop-image").remove(),e(".lp-user-profile-avatar").html(t.avatar),a.$().attr("data-custom","yes"),a.$(".profile-picture").toggleClass("profile-avatar-current").filter(".profile-avatar-current").html(t.avatar))}})},$:function(t){return t?e(this.$el).find(t):e(this.$el)},_removePhoto:function(t){t.preventDefault(),confirm("Are you sure?")&&(this.$().removeAttr("data-custom"),this.$(".profile-picture").toggleClass("profile-avatar-current"),this.$("#submit").prop("disabled",!1),e(".lp-user-profile-avatar").html(this.$(".profile-avatar-current").find("img").clone()))},_upload:function(e){e.preventDefault()},_cancel:function(e){e.preventDefault(),this.$crop&&this.$crop.remove(),this.$(".lp-avatar-preview").removeClass("croping")},filesAdded:function(e,t){e.files.splice(0,e.files.length-1),this.$(".lp-avatar-preview").addClass("uploading"),this.$(".lp-avatar-upload-progress-value").width(0),this.uploader.start()},uploadProgress:function(e,t){this.$(".lp-avatar-upload-progress-value").css("width",t.percent+"%")},uploadError:function(e,t){this.$(".lp-avatar-preview").addClass("upload-error").removeClass("uploading"),this.$(".lp-avatar-upload-error").html(t)},fileUploaded:function(t,a,i){this.$(".lp-avatar-preview").removeClass("upload-error").removeClass("uploading");var r=this,o=LP.parseJSON(i.response);o.url&&(this.avatar=o.url,e("<img/>").attr("src",o.url).load((function(){r.model.set(e.extend(o,{width:this.width,height:this.height})),r.crop()})))},crop:function(){this.model.set("r",Math.random()),new t.Crop(this),this.$("#submit").prop("disabled",!1)},_getUploader:function(){return this.uploader||(this.uploader=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:"lp-upload-photo",container:e("#lp-user-edit-avatar").get(0),url:("undefined"!=typeof lpGlobalSettings?lpGlobalSettings.ajax:"").addQueryVar("action","learnpress_upload-user-avatar"),filters:{max_file_size:"10mb",mime_types:[{title:"Image",extensions:"png,jpg,bmp,gif"}]},file_data_name:"lp-upload-avatar",init:{PostInit:function(){},FilesAdded:this.filesAdded,UploadProgress:this.uploadProgress,FileUploaded:this.fileUploaded,Error:this.uploadError}}),this.uploader.init()),this.uploader}}),t.Model=Backbone.Model.extend({}),t.Crop=function(t){var a=this,i=t.model.toJSON(),r=e(LP.template("tmpl-crop-user-avatar")(i));r.appendTo(t.$("#profile-avatar-uploader")),t.$crop=r;var o=r.find("img"),s=0,n=0,l=0,d=0,p=0,u=0;this.initCrop=function(){i.viewWidth/i.viewHeight>=i.width/i.height?(s=i.viewWidth,n=i.height*i.viewWidth/i.width,l=0,d=-(n-i.viewHeight)/2):(n=i.viewHeight,s=i.width*i.viewHeight/i.height,d=0,l=-(s-i.viewWidth)/2),p=s,u=n,o.draggable({drag:function(t,a){a.position.left>0&&(a.position.left=0),a.position.top>0&&(a.position.top=0);var r=i.viewWidth-p,o=i.viewHeight-u;r>a.position.left&&(a.position.left=r),o>a.position.top&&(a.position.top=o),e(document.body).addClass("profile-dragging")},stop:function(r,s){l=parseInt(o.css("left")),d=parseInt(o.css("top")),t=(Math.abs(l)+i.viewWidth/2)/p,c=(Math.abs(d)+i.viewHeight/2)/u,a.update({width:p,height:u,top:d,left:l}),e(document.body).removeClass("profile-dragging")}});var t=(Math.abs(l)+i.viewWidth/2)/s,c=(Math.abs(d)+i.viewHeight/2)/n;r.find(".lp-zoom > div").slider({create:function(){a.update({width:s,height:n,top:d,left:l})},slide:function(r,o){p=s+o.value/100*i.width*2,u=n+o.value/100*i.height*2;var f=i.viewWidth/2-p*t,h=i.viewHeight/2-u*c;f>0&&(f=0),h>0&&(h=0);var v=parseInt(i.viewWidth-p),g=parseInt(i.viewHeight-u);v>f&&(f=l=v),g>h&&(h=d=g),a.update({width:p,height:u,top:h,left:f}),e(document.body).addClass("profile-resizing"),console.log(o.value,i)},stop:function(){e(document.body).removeClass("profile-resizing")}})},this.update=function(t){o.css({width:t.width,height:t.height,top:t.top,left:t.left});var a=t.width/i.width,s=parseInt(Math.abs(t.left/a)),n=parseInt(Math.abs(t.top/a)),l=s+parseInt(i.viewWidth/a),d=n+parseInt(i.viewHeight/a),p=e.extend(t,{width:i.viewWidth,height:i.viewHeight,r:a,points:[s,n,l,d].join(",")});r.find('input[name^="lp-user-avatar-crop"]').each((function(){var t=e(this),a=t.data("name");"name"!=a&&void 0!==p[a]&&t.val(p[a])}))},this.initCrop()},e(document).on("submit","#learn-press-form-login",(function(t){var a=e(this),i=a.serialize();return a.find(".learn-press-error, .learn-press-notice, .learn-press-message").fadeOut(),a.find("input").attr("disabled",!0),LP.doAjax({data:{"lp-ajax":"login",data:i},success:function(t,i){LP.showMessages(t.message,a,"LOGIN_ERROR"),"error"==t.result&&(a.find("input").attr("disabled",!1),e('#learn-press-form-login input[type="text"]').trigger("focus")),t.redirect&&LP.reload(t.redirect)},error:function(){LP.showMessages("",a,"LOGIN_ERROR"),a.find("input").attr("disabled",!1),e('#learn-press-form-login input[type="text"]').trigger("focus")}}),!1})),e(document).on("click",".table-orders .cancel-order",(function(t){t.preventDefault();var a=e(this).attr("href");return LP.alert(learn_press_js_localize.confirm_cancel_order,(function(e){e&&(window.location.href=a)})),!1})),e(document).ready((function(){var i=e("#lp-user-profile-form form"),r=i.serialize(),o=null,s=i.find("#lp-profile-edit-password-form");function n(){i.find("#submit").prop("disabled",!(i.serialize()!=r))}0==s.length?i.on("keyup change","input, textarea, select",(function(){o&&clearTimeout(o),o=setTimeout(n,300)})):s.on("change keyup","input",(function(t){e(t.target).attr("name");var a=i.find("#pass0"),r=i.find("#pass1"),o=i.find("#pass2"),s=!((r.val()||o.val())&&r.val()!=o.val());i.find("#lp-password-not-match").toggleClass("hide-if-js",s),i.find("#submit").prop("disabled",!(s&&a.val()&&r.val()&&o.val()))}));var l={};"undefined"!=typeof lpProfileUserSettings&&(l.viewWidth=parseInt(lpProfileUserSettings.avatar_size.width),l.viewHeight=parseInt(lpProfileUserSettings.avatar_size.height)),new t(l),a.recoverOrder()})).on("click",".btn-load-more-courses",(function(t){var a=e(this),i=a.data("paged")||1,r=a.data("pages")||1,o=a.data("container"),s=e("#"+o),n=a.data("url");if(i++,a.data("paged",i).prop("disabled",!0).removeClass("btn-ajax-off").addClass("btn-ajax-on"),n)n=n.addQueryVar("current_page",i);else{var l=window.location.href.split("?");n=l[0].match(/\/([0-9]+)\//)?l[0].replace(/\/([0-9]+)\//,i):l[0]+i,l[1]&&(n+="?"+l[1])}e.ajax({url:n,data:a.data("args"),success:function(t){s.append(e(t).find("#"+o).children()),i>=r?a.remove():a.prop("disabled",!1).removeClass("btn-ajax-on").addClass("btn-ajax-off")}})}));var a={recoverOrder:function(t){var a=this,i=e(".order-recover"),r=i.find(".button-recover-order"),o=i.find('input[name="order-key"]'),s=function(){r.addClass("disabled").attr("disabled","disabled"),i.find(".learn-press-message").remove(),e.post({url:"",data:i.serializeJSON(),success:function(t){if((t=LP.parseJSON(t)).message){var a=e('<div class="learn-press-message icon"><i class="fa"></i> '+t.message+"</div>");"error"==t.result&&a.addClass("error"),i.prepend(a)}t.redirect&&(window.location.href=t.redirect),r.removeClass("disabled").removeAttr("disabled","")}})};r.on("click",s),o.on("change",(function(){r.prop("disabled",!a.value)}))}}}(jQuery)}});