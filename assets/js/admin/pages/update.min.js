!function(t){"use strict";const e=function(t){this.data=t;let e=-1,a=null,s=null,n=Object.keys(this.data);this.reset=function(t){return t=void 0===t||t>n.length-1||t<0?0:t,e=t,a=n[t],s=this.data[a],s},this.next=function(){return!(e>=n.length-1)&&(e++,this.reset(e),s)},this.prev=function(){return!(e<=0)&&(e--,this.reset(e),s)},this.currentVersion=function(){return a},this.hasPackage=function(){return n.length},this.getPercentCompleted=function(){return e/n.length},this.getTotal=function(){return n.length},this.data},a={el:"#learn-press-updater",data:{packages:null,status:"",force:!1},watch:{packages(t,e){}},mounted(){t(this.$el).show()},methods:{getUpdatePackages(a){const s=this;t.ajax({url:lpGlobalSettings.admin_url,data:{"lp-ajax":"get-update-packages",force:this.force,_wpnonce:lpGlobalSettings._wpnonce},success(t){const n=LP.parseJSON(t);s.packages=new e(n),a&&a.call(s)}})},start(t,e){this.packages=null,this.force=e,this.getUpdatePackages((function(){if(this.packages.hasPackage()){const t=this.packages.next();this.status="updating",this.doUpdate(t)}}))},getPackages(){return this.packages?this.packages.data:{}},hasPackage(){return!t.isEmptyObject(this.getPackages())},updateButtonClass(){return{disabled:"updating"===this.status}},doUpdate(e,a){const s=this;e=e||this.packages.next(),a=a||1,e?t.ajax({url:lpGlobalSettings.admin_url,data:{"lp-ajax":"do-update-package",package:e,version:this.packages.currentVersion(),_wpnonce:lpGlobalSettings._wpnonce,force:this.force,i:a},success(n){const i=LP.parseJSON(n);t(s.$el).find(".updater-progress-status");if("yes"===i.done)s.update(100*s.packages.getPercentCompleted()),s.doUpdate();else{let t=100*s.packages.getPercentCompleted();if(i.percent){t+=1/s.packages.getTotal()*i.percent}s.update(t),s.doUpdate(e,++a)}},error(){s.doUpdate(e,a)}}):(s.update(100).addClass("completed"),setTimeout((function(t){t.status="completed"}),2e3,this))},update(e){return t(this.$el).find(".updater-progress-status").css("width",e+"%").attr("data-value",parseInt(e))}}};t(document).ready((function(){if(window.lpGlobalSettings=window.lpGlobalSettings||{},t("#learn-press-updater").length){new Vue(a)}}))}(jQuery);